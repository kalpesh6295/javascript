<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Memory Card Game</title>
<style>
    body {
        font-family: 'Arial', sans-serif;
        background: #f4f4f4;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
    }
    .game-container {
        width: 90%;
        max-width: 800px;
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    .controls {
        display: flex;
        justify-content: space-between;
        margin-bottom: 20px;
    }
    .grid {
        display: grid;
        gap: 10px;
        perspective: 1000px;
    }
    .card {
        width: 100px;
        height: 100px;
        position: relative;
        transform-style: preserve-3d;
        transition: transform 0.5s;
        cursor: pointer;
    }
    .card div {
        position: absolute;
        width: 100%;
        height: 100%;
        backface-visibility: hidden;
        display: flex;
        justify-content: center;
        align-items: center;
        border-radius: 8px;
        font-size: 2em;
    }
    .front-face {
        background: #333;
        color: white;
    }
    .back-face {
        background: #ff9800;
        transform: rotateY(180deg);
    }
    .card.flipped {
        transform: rotateY(180deg);
    }
    .card.matched {
        visibility: hidden;
    }
    button {
        padding: 10px 15px;
        background: #007BFF;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }
    @media (max-width: 768px) {
        .card { width: 80px; height: 80px; }
    }
</style>
</head>
<body>

<div class="game-container">
    <div class="controls">
        <button onclick="startGame('easy')">Easy</button>
        <button onclick="startGame('medium')">Medium</button>
        <button onclick="startGame('hard')">Hard</button>
        <div>Time: <span id="timer">60</span>s</div>
        <div>Best Time: <span id="bestTime">--</span>s</div>
    </div>
    <div id="grid" class="grid"></div>
</div>

<script>
    let grid;
    let cards = [];
    let flippedCards = [];
    let matchedCards = 0;
    let timerInterval;
    let timeLeft = 60;
    const images = ['ðŸ', 'ðŸŒ', 'ðŸ’', 'ðŸ‡', 'ðŸŠ', 'ðŸ“', 'ðŸ‰', 'ðŸŽ'];
    
    function startGame(difficulty) {
        clearInterval(timerInterval);
        const sizes = {easy: [3, 4], medium: [4, 4], hard: [5, 4]};
        const [rows, cols] = sizes[difficulty];
        const pairs = (rows * cols) / 2;
        let selectedImages = images.slice(0, pairs).concat(images.slice(0, pairs)).sort(() => Math.random() - 0.5);
        
        grid = document.getElementById('grid');
        grid.style.gridTemplateColumns = `repeat(${cols}, 100px)`;
        grid.innerHTML = '';
        cards = [];
        flippedCards = [];
        matchedCards = 0;
        timeLeft = 60;
        document.getElementById('timer').innerText = timeLeft;
        
        for(let image of selectedImages) {
            let card = document.createElement('div');
            card.className = 'card';
            card.dataset.image = image;
            card.innerHTML = `<div class="front-face">?</div><div class="back-face">${image}</div>`;
            card.addEventListener('click', flipCard);
            grid.appendChild(card);
            cards.push(card);
        }
        
        timerInterval = setInterval(updateTimer, 1000);
        updateBestTime(difficulty);
    }

    function flipCard() {
        if(flippedCards.length < 2 && !this.classList.contains('flipped') && !this.classList.contains('matched')) {
            this.classList.add('flipped');
            flippedCards.push(this);
            if(flippedCards.length === 2) {
                setTimeout(checkForMatch, 1000);
            }
        }
    }

    function checkForMatch() {
        if(flippedCards[0].dataset.image === flippedCards[1].dataset.image) {
            flippedCards.forEach(card => {
                card.classList.add('matched');
                card.classList.remove('flipped');
            });
            matchedCards += 2;
            if(matchedCards === cards.length) {
                endGame();
            }
        } else {
            flippedCards.forEach(card => card.classList.remove('flipped'));
        }
        flippedCards = [];
    }

    function updateTimer() {
        if(timeLeft > 0) {
            timeLeft--;
            document.getElementById('timer').innerText = timeLeft;
        } else {
            endGame(true);
        }
    }

    function endGame(outOfTime = false) {
        clearInterval(timerInterval);
        if(!outOfTime) {
            alert('Congratulations! You matched all the cards!');
            let difficulty = document.activeElement.textContent.toLowerCase();
            let bestTime = localStorage.getItem(`bestTime${difficulty}`);
            if(!bestTime || timeLeft > bestTime) {
                localStorage.setItem(`bestTime${difficulty}`, 60 - timeLeft);
                updateBestTime(difficulty);
            }
        } else {
            alert('Time\'s up!');
        }
    }

    function updateBestTime(difficulty) {
        let bestTime = localStorage.getItem(`bestTime${difficulty}`) || '--';
        document.getElementById('bestTime').innerText = bestTime;
    }
</script>

</body>
</html>